{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Compound Workflow v3 Execution Config",
  "$comment": "Schema for .claude/execution-config.json. Controls runtime behavior during /execute: auto-proceed mode, milestone pausing, deferred finding promotion, runtime QA pause, and end-of-queue verification fix pass configuration.",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "auto_proceed",
    "milestone_pause",
    "deferred_auto_action",
    "runtime_qa_pause",
    "qa_fix_pass"
  ],
  "properties": {
    "_version": {
      "type": "string",
      "description": "Schema version for tracking configuration format evolution."
    },
    "auto_proceed": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "enabled"
      ],
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Never pause between tasks or steps. Display plan and continue immediately. The user can interrupt if needed â€” the default is to keep building."
        },
        "description": {
          "type": "string"
        }
      }
    },
    "milestone_pause": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "enabled"
      ],
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "When true, pause after each milestone review for user acknowledgment. When false, continue straight to the next milestone after review passes (or after fixes if FIXABLE). BLOCKED milestones always pause regardless of this setting."
        },
        "description": {
          "type": "string"
        }
      }
    },
    "deferred_auto_action": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "action"
      ],
      "properties": {
        "action": {
          "type": "string",
          "enum": [
            "promote",
            "defer",
            "ask",
            "preview"
          ],
          "description": "What to do with deferred findings at milestone boundaries when milestone_pause is false. 'promote' = auto-add all as tasks, 'defer' = auto-defer all to post-v1, 'ask' = always ask user regardless of milestone_pause, 'preview' = display findings then auto-promote without pausing."
        },
        "description": {
          "type": "string"
        }
      }
    },
    "runtime_qa_pause": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "enabled"
      ],
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "When true, pause after runtime QA results for user review before /retro. When false, write findings to observations.md and proceed to /retro automatically."
        },
        "description": {
          "type": "string"
        }
      }
    },
    "qa_fix_pass": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "enabled",
        "major_action",
        "max_cycles"
      ],
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Controls whether the end-of-queue verification fix pass runs after all tasks complete."
        },
        "major_action": {
          "type": "string",
          "enum": [
            "fix",
            "defer",
            "ask"
          ],
          "description": "Controls MAJOR findings: 'fix' = fix them, 'defer' = auto-defer to post-v1, 'ask' = ask user per finding. CRITICAL findings always fixed regardless."
        },
        "max_cycles": {
          "type": "integer",
          "minimum": 1,
          "maximum": 5,
          "description": "Maximum fix + re-verify cycles allowed (default 3). Prevents infinite loops if issues persist."
        },
        "description": {
          "type": "string"
        }
      }
    }
  }
}
