---
import "@/styles/global.css";
import SEOHead from "@/components/seo/SEOHead.astro";
import type { Locale } from "@/i18n/utils";

interface Props {
  title: string;
  description: string;
  locale: Locale;
  path: string;
  ogImage?: string;
  type?: "website" | "article";
  publishedTime?: string;
  noindex?: boolean;
}

const { locale, ...seoProps } = Astro.props;

const cfBeacon = import.meta.env.PUBLIC_CF_BEACON;

const organizationSchema = JSON.stringify({
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "Auryth BV",
  "url": "https://auryth.ai",
  "logo": "https://auryth.ai/auryth-logo.svg",
  "description": "AI-powered Belgian tax research platform",
  "address": {
    "@type": "PostalAddress",
    "addressLocality": "Antwerp",
    "addressCountry": "BE",
  },
});

const softwareSchema = JSON.stringify({
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "Auryth TX AI",
  "applicationCategory": "BusinessApplication",
  "operatingSystem": "Web",
  "description": "AI-powered tax research tool for Belgian fiscal professionals",
  "url": "https://auryth.ai",
  "provider": {
    "@type": "Organization",
    "name": "Auryth BV",
    "url": "https://auryth.ai",
  },
  "offers": {
    "@type": "Offer",
    "availability": "https://schema.org/PreOrder",
    "price": "0",
    "priceCurrency": "EUR",
    "description": "Pre-launch waitlist â€” founding member pricing available",
  },
});
---

<!doctype html>
<html lang={locale} class="scroll-smooth">
  <head>
    <SEOHead locale={locale} {...seoProps} />
    <script type="application/ld+json" set:html={organizationSchema} />
    <script type="application/ld+json" set:html={softwareSchema} />
    <slot name="head" />
    {/* Dark mode: inline script prevents flash of wrong theme */}
    <script is:inline>
      (function () {
        const stored = localStorage.getItem("AURYTH-theme");
        if (stored === "dark" || (!stored && window.matchMedia("(prefers-color-scheme: dark)").matches)) {
          document.documentElement.classList.add("dark");
        }
      })();
    </script>
  </head>
  <body class="bg-background text-foreground min-h-screen antialiased">
    <a href="#main-content" class="sr-only focus:not-sr-only focus:fixed focus:top-4 focus:left-4 focus:z-50 focus:rounded-lg focus:bg-primary focus:px-4 focus:py-2 focus:text-primary-foreground">
      Skip to main content
    </a>
    <slot />
    {cfBeacon && (
      <script
        defer
        src="https://static.cloudflareinsights.com/beacon.min.js"
        data-cf-beacon={`{"token":"${cfBeacon}"}`}
        is:inline
      />
    )}
  </body>
</html>
