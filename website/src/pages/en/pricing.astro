---
import BaseLayout from "@/layouts/BaseLayout.astro";
import Section from "@/components/layout/Section.astro";
import Card from "@/components/ui/Card.astro";
import Badge from "@/components/ui/Badge.astro";
import PricingToggle from "@/components/marketing/PricingToggle";
import ComparisonMatrix from "@/components/marketing/ComparisonMatrix.astro";
import PricingFAQ from "@/components/marketing/PricingFAQ.astro";
import { t } from "@/i18n/utils";

const locale = "en";

// Tier data inline to avoid island serialization issues
const tiers = [
  { id: "solo", name: "Solo", monthly: 99, annual: 89, founding: 69, queries: "~150–300/mo", features: ["1 seat", "1 jurisdiction", "Source citations", "Confidence scoring", "Query history", "Email support"] },
  { id: "team", name: "Team", monthly: 299, annual: 269, founding: 209, queries: "~750–3,000/mo", highlighted: true, features: ["5 seats", "1 jurisdiction", "Source citations", "Confidence scoring", "Shared workspace", "Client folders", "Templates", "Priority support"] },
  { id: "firm", name: "Firm", monthly: 549, annual: 494, founding: 384, queries: "~2,000–8,000/mo", features: ["15 seats", "2 jurisdictions", "Source citations", "Confidence scoring", "Admin dashboard", "Knowledge base", "Bulk analysis", "Audit trail", "SSO", "Dedicated support"] },
  { id: "enterprise", name: "Enterprise", monthly: null, annual: null, founding: null, queries: "Unlimited", features: ["Unlimited seats", "All jurisdictions", "All features", "Custom integrations", "SLA", "Dedicated account manager"] },
];
---

<BaseLayout
  title={`${t("pricing.title", locale)} — ${t("site.title", locale)}`}
  description={t("site.description", locale)}
  locale={locale}
  path="/pricing/"
>
  <main id="main-content">
    <Section class="py-24 md:py-32">
      <div class="mx-auto max-w-3xl text-center">
        <h1 class="text-display text-foreground">{t("pricing.title", locale)}</h1>
        <p class="mt-4 text-body-lg text-muted-foreground">{t("pricing.subtitle", locale)}</p>
      </div>

      <div class="mt-8 flex justify-center">
        <PricingToggle
          client:load
          monthlyLabel={t("pricing.monthly", locale)}
          annualLabel={t("pricing.annual", locale)}
          annualSave={t("pricing.annual_save", locale)}
        />
      </div>

      {/* Founding member offer */}
      <p class="mt-6 text-center text-body-sm font-medium text-primary-text">
        {t("pricing.founding_offer", locale)}
      </p>
    </Section>

    {/* Tier cards — UIX-05 */}
    <Section>
      <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-4">
        {tiers.map((tier) => (
          <Card highlighted={tier.highlighted} class={tier.highlighted ? "shadow-lg" : ""}>
            <div class="flex flex-col h-full">
              <div class="mb-4">
                {tier.highlighted && (
                  <Badge class="mb-2">{t("pricing.most_popular", locale)}</Badge>
                )}
                <h3 class="text-body-lg font-semibold text-foreground">{tier.name}</h3>
              </div>

              {tier.monthly ? (
                <div class="mb-4">
                  {/* Founding member price (PRICE-06) */}
                  <div class="flex items-baseline gap-2">
                    <span class="text-display-sm font-bold text-foreground">€{tier.founding}</span>
                    <span class="text-body-sm text-muted-foreground">{t("pricing.per_month", locale)}</span>
                  </div>
                  <p class="text-body-xs text-muted-foreground line-through">€{tier.monthly}{t("pricing.per_month", locale)}</p>
                </div>
              ) : (
                <div class="mb-4">
                  <span class="text-display-sm font-bold text-foreground">{t("pricing.custom", locale)}</span>
                </div>
              )}

              <p class="mb-4 text-body-xs text-muted-foreground">{tier.queries} queries</p>

              <ul class="mb-6 flex-1 space-y-2">
                {tier.features.map((f: string) => (
                  <li class="flex items-start text-body-sm text-muted-foreground">
                    <span class="mr-2 text-primary-text">✓</span>
                    {f}
                  </li>
                ))}
              </ul>

              <a
                href={tier.monthly ? `/${locale}/waitlist/` : `/${locale}/contact/`}
                class="inline-flex h-11 min-h-[44px] w-full items-center justify-center rounded-lg bg-primary px-6 text-body-sm font-medium text-primary-foreground transition-colors hover:bg-primary/90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"
              >
                {tier.monthly ? t("pricing.cta", locale) : t("pricing.enterprise_cta", locale)}
              </a>
            </div>
          </Card>
        ))}
      </div>
    </Section>

    {/* Jurisdiction add-ons — PRICE-03 */}
    <Section muted>
      <h2 class="text-h2 text-foreground">Jurisdiction Add-ons</h2>
      <p class="mt-2 text-body text-muted-foreground">Extend coverage beyond Belgium</p>
      <div class="mt-8 grid gap-6 sm:grid-cols-2">
        <Card>
          <h3 class="text-body-lg font-semibold text-foreground">+1 Jurisdiction</h3>
          <p class="mt-2 text-body-sm text-muted-foreground">Solo +€29/mo · Team +€79/mo · Firm +€149/mo</p>
        </Card>
        <Card>
          <h3 class="text-body-lg font-semibold text-foreground">Benelux Bundle</h3>
          <p class="mt-2 text-body-sm text-muted-foreground">Solo +€49/mo · Team +€129/mo · Firm +€249/mo</p>
          <p class="mt-1 text-body-xs text-primary-text">Save vs. individual add-ons</p>
        </Card>
      </div>
    </Section>

    {/* Feature comparison matrix — PRICE-04 / UIX-05 */}
    <Section>
      <h2 class="text-h2 text-foreground">Feature Comparison</h2>
      <p class="mt-2 text-body text-muted-foreground">See what's included in each plan</p>
      <div class="mt-8">
        <ComparisonMatrix locale={locale} labels={{ solo: "Solo", team: "Team", firm: "Firm", enterprise: "Enterprise" }} />
      </div>
    </Section>

    {/* Pricing FAQ */}
    <Section muted>
      <h2 class="text-h2 text-foreground">Frequently Asked Questions</h2>
      <div class="mt-8 mx-auto max-w-3xl">
        <PricingFAQ faqs={[{ question: "When does Auryth TX AI launch?", answer: "We are currently in pre-launch. Join the waitlist to be notified when we launch and to secure founding member pricing at 30%% off." }, { question: "Is there a free trial?", answer: "Yes. Every plan includes a 14-day free trial with full access. No credit card required to start." }, { question: "Can I change plans later?", answer: "Absolutely. You can upgrade or downgrade your plan at any time. Changes take effect at the next billing cycle." }, { question: "What payment methods do you accept?", answer: "We will accept all major credit cards and SEPA direct debit at launch." }, { question: "Is my data secure?", answer: "Yes. We are a Belgian company subject to GDPR. Your data is processed and stored within the EU. See our privacy policy for details." }]} />
      </div>
    </Section>
  </main>
</BaseLayout>
